[package]
name = "zenavif"
version = "0.1.0"
edition = "2024"
rust-version = "1.93"
license = "AGPL-3.0-or-later"
description = "Pure Rust AVIF image codec powered by rav1d and ravif"
categories = ["multimedia::images"]
keywords = ["avif", "decoder", "encoder", "av1", "image"]
repository = "https://github.com/imazen/zenavif"

[dependencies]
# rav1d: C FFI-based decoder for asm feature (fastest)
rav1d = { version = "1.1.0", default-features = false, features = ["bitdepth_8", "bitdepth_16"], optional = true }
# rav1d-safe: 100% safe managed API decoder (no c-ffi feature!)
rav1d-safe = { version = "0.1.0", default-features = false, features = ["bitdepth_8", "bitdepth_16"] }
archmage = { version = "0.6.1", features = ["macros", "safe_unaligned_simd"] }
magetypes = "0.6"
safe_unaligned_simd = "0.2.4"
zenavif-parse = "0.2.0"
yuv = "0.8.10"
imgref = "1.12.0"
rgb = { version = "0.8.52", default-features = false, features = ["as-bytes"] }
enough = "0.3.1"
thiserror = { version = "2.0", default-features = false }
whereat = "0.1.3"
log = "0.4"
ravif = { path = "../ravif/ravif", default-features = false, optional = true }
zencodec-types = { path = "../zencodec-types" }
linear-srgb = "0.4"

[dev-dependencies]
archmage = { version = "0.6.1", features = ["std"] }
env_logger = { version = "0.11", default-features = false }
png = "0.18.0"
image = "0.25"
criterion = { version = "0.5", features = ["html_reports"] }

[[bench]]
name = "decode_benchmark"
harness = false

[[bench]]
name = "yuv_conversion_benchmark"
harness = false

[[bench]]
name = "yuv_crate_comparison"
harness = false

[features]
default = []
# Decode with hand-written assembly via C FFI (fastest, uses unsafe)
unsafe-asm = ["dep:rav1d", "rav1d/asm"]
# AVIF encoding via ravif (pure Rust by default)
encode = ["dep:ravif"]
# Encoding with hand-written assembly (fastest, uses unsafe)
encode-asm = ["encode", "ravif/asm"]
# Encoding with multi-threading
encode-threading = ["encode", "ravif/threading"]
# Encoding with imazen/rav1e fork features (QM, VAQ, still-image tuning, lossless)
encode-imazen = ["encode", "ravif/imazen"]

